% $Id: EHC.lag 199 2004-05-12 19:11:13Z andres $

%%[0
%include lhs2TeX.fmt
%include afp.fmt
%%]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Abstract syntax for Ty
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Top level
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%[1.TyAGItf
DATA TyAGItf
  | AGItf       ty              : Ty
%%]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Type structure
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%[1.Ty
DATA Ty
  | Con         nm              : {HsName}
  | App         func            : Ty
                arg             : Ty
  | Any
%%]

%%[2.TyVar
DATA Ty
  | Var         tv              : {TyVarId}
%%]

%%[3.TyVar -2.TyVar
DATA Ty
  | Var         tv              : {TyVarId}
                categ           : TyVarCateg

DATA TyVarCateg
  | Plain
  | Fixed
%%]

%%[3.Quant
DATA Ty
  | Quant       tv              : {TyVarId}
                ty              : Ty
%%]

%%[4.Quant -3.Quant
DATA Ty
  | Quant       qu              : TyQu
                tv              : {TyVarId}
                ty              : Ty

DATA TyQu
  | Forall
  | Exists
%%]

%%[6
DATA TyQu
  | KiForall
  | KiExists
%%]

%%[6_2
DATA Ty
  | Bind        tv              : {TyVarId}
                tyL             : TyL

TYPE TyL        =   [Ty]
%%]

%%[7
DATA Ty
  | Ext         ty              : Ty
                nm              : {HsName}
                extTy           : Ty
%%]

%%[9
DATA Ty
  | Pred        pr              : Pred
  | Impls       impls           : Impls

DATA Impls
  | Tail        iv              : {ImplsVarId}
  | Cons        iv              : {ImplsVarId}
                pr              : Pred
                pv              : {PredOccId}
                tl              : Impls
  | Nil
%%]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Predicates
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%[9
DATA Pred
  | Class       ty              : Ty
%%]

%%[10
DATA Pred
  | Lacks       ty              : Ty
                nm              : {HsName}
%%]

%%[11
DATA Pred
  | Equal       tvTy            : Ty
                ty              : Ty
%%]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% SET's
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%[1.AllTy
SET AllTy       = Ty
SET AllAllTy    = AllTy
%%]

%%[3.AllTy -1.AllTy
SET AllTy       = Ty
SET AllAllTy    = AllTy TyVarCateg
%%]

%%[4.AllTy -3.AllTy
SET AllTy       = Ty
SET AllAllTy    = AllTy TyVarCateg TyQu
%%]

%%[6_2.AllTy -4.AllTy
SET AllTy       = Ty TyL
SET AllAllTy    = AllTy TyVarCateg TyQu
%%]

%%[9.AllTy -4.AllTy
SET AllTy       = Ty Pred Impls
SET AllAllTy    = AllTy TyVarCateg TyQu
%%]


