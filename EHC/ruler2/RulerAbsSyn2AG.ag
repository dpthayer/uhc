-------------------------------------------------------------------------
-- Ruler AST, pass 2
-------------------------------------------------------------------------

-------------------------------------------------------------------------
-- Declarations
-------------------------------------------------------------------------

DATA Decl
  | RsVw                decl        : RsVwDecl
  | AttrAG              decl        : AttrAGDecl
  | Chunk               nm          : {Nm}
                        decl        : Decl

TYPE Decls = [Decl]

SET AllDc = Decl Decls

DATA RsVwDecl
  | Rs                  nm          : {Nm}
                        scNm        : {Nm}
                        inclVwS     : {Set.Set Nm}
                        descr       : {String}
                        vwDecls     : VwDecls
  | Grp                 nm          : {Nm}
                        scNm        : {Nm}
                        inclVwS     : {Set.Set Nm}
                        descr       : {String}
                        rlNms       : {[(Nm,Nm)]}

TYPE RsVwDecls = [RsVwDecl]

SET AllRs = RsVwDecl RsVwDecls

DATA AttrAGDecl
  | Attr                ndNm        : {Nm}
                        inhAts      : {[(Nm,Nm)]}
                        inhsynAts   : {[(Nm,Nm)]}
                        synAts      : {[(Nm,Nm)]}

SET AllAtAG = AttrAGDecl

DATA VwDecl
  | Vw                  nm          : {Nm}
                        rlDecls     : RlDecls

TYPE VwDecls = [VwDecl]

SET AllVw = VwDecl VwDecls

DATA RlDecl
  | Rl                  nm          : {Nm}
                        fullNm      : {Nm}
                        pos         : {SPos}
                        mbAGStr     : {Maybe String}
                        inclVwS     : {Set.Set Nm}
                        preJds      : Jds
                        postJds     : Jds
  | LTX                 nm          : {Nm}
                        rlNm        : {Nm}
                        vwNm        : {Nm}
                        pos         : {SPos}
                        preJds      : Jds
                        postJds     : Jds
  | AG                  nm          : {Nm}
                        pos         : {SPos}
                        arule       : ARule
  | Chunk               nm          : {Nm}
                        rl          : RlDecl

TYPE RlDecls = [RlDecl]

SET AllRl = RlDecl RlDecls

DATA Jd
  | Ats                 nm          : {Nm}
                        scNm        : {Nm}
                        ats         : JdAts
  | Expr                nm          : {Nm}
                        scNm        : {Nm}
                        expr        : Expr
  | LTX                 nm          : {Nm}
                        scNm        : {Nm}
                        expr        : Expr

TYPE Jds = [Jd]

SET AllJd = Jd Jds

DATA JdAt
  | At                  nm          : {Nm}
                        expr        : Expr

TYPE JdAts = [JdAt]

SET AllAt = JdAt JdAts

SET AllDecl
  = AllDc AllRs AllVw
    AllRl AllJd AllAt
    AllAtAG

-------------------------------------------------------------------------
-- Sets of AST data's
-------------------------------------------------------------------------

SET AllAS2 = AllDecl
