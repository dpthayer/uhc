%% ----------------------------------------------------------------------------
%% CHECK FOR POLYCODE
%% ----------------------------------------------------------------------------

\providecommand*{\sethscode}[1]{%
  \PackageError{boxedcode}{%
    Command \@backslashchar sethscode unavailable.\MessageBreak%
    Make sure that you have included polycode.fmt}{}}

%% ----------------------------------------------------------------------------
%% PACKAGES
%% ----------------------------------------------------------------------------

\RequirePackage{colortbl}
\RequirePackage{xcolor}

%% ----------------------------------------------------------------------------
%% BOXES
%% ----------------------------------------------------------------------------

\newenvironment{clrbox}[2]%
  {{\parskip=0pt\parindent=0pt\par\vskip\abovedisplayskip\noindent}%
   \arrayrulecolor{#2}%
   \setlength{\arrayrulewidth}{1.4\arrayrulewidth}%
   \defaultcolumn{l}
   \tabular{%
     @{}|>{\columncolor{#1!20}\(}p{.80\columnwidth}<{\)}|@{}}%
   \hline%
   \let\\=\@normalcr}%
  {\tabularnewline\hline%
   \endtabular%
   {\parskip=0pt\parindent=0pt\par\vskip\belowdisplayskip\noindent}%
   \ignorespacesafterend}

%% ----------------------------------------------------------------------------
%% COLOURS
%% ----------------------------------------------------------------------------

\definecolor{hsbg}{cmyk}{0,0.25,0.9,0}
\definecolor{hsborder}{cmyk}{0.2,1,0.9,0.1}

%% ----------------------------------------------------------------------------
%% HASKELL CODE
%% ----------------------------------------------------------------------------

\newenvironment{hsbox}%
  {\clrbox{hsbg}{hsborder}\hscodestyle\pboxed}%
  {\endpboxed\endclrbox}
\sethscode{hsbox}
